package org.sasanlabs.service.vulnerability.xss.reflected;

import static org.junit.jupiter.api.Assertions.*;

import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.CsvSource;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

public class XSSInImgTagAttributeTest {    

    @ParameterizedTest
    @CsvSource({"''onerror='alert(1);'", " onerror=alert`1`", "http://evil.org/maliciousImage.png"})
    public void getVulnerablePayloadLevelSecure_exploitsFromLowerLevels(String input) {
        XSSInImgTagAttribute subject = new XSSInImgTagAttribute();

        ResponseEntity<String> actual = subject.getVulnerablePayloadLevelSecure(input);

        assertSame(actual.getStatusCode(), HttpStatus.BAD_REQUEST);
    }
}
